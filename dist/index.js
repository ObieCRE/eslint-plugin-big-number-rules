/*
 * eslint-plugin-big-number-rules
 * v1.5.6
 * https://github.com/shuckster/eslint-plugin-big-number-rules
 * License: MIT
 */
"use strict";var e={isPojo:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}};const{isPojo:t}=e;function r(e="construct",r="BigNumber"){return n=>{const{settings:i}=n,a=i["big-number-rules"]?.[e]??r;return t(r)&&t(a)&&r!==a?{...r,...a}:a}}const n=r("construct","BigNumber");var i={makeSettingGetter:r,isPojo:t,getConstruct:n};const{makeSettingGetter:a,getConstruct:o}=i,s=a("arithmetic",{"+":"plus","-":"minus","/":"dividedBy","*":"multipliedBy","**":"exponentiatedBy","%":"modulo"}),c=a("comparison",{"<":"isLessThan","<=":"isLessThanOrEqualTo","===":"isEqualTo","==":"isEqualTo",">=":"isGreaterThanOrEqualTo",">":"isGreaterThan"}),u=a("bitwise",{">>":"shiftedBy",">>>":"shiftedBy","<<":["${L}","shiftedBy","-${R}"]}),l=a("sum","sum"),p=a("supportsSum",!0),f=a("supportsBitwise",!0);function m(e){return"CallExpression"===e?.type&&"MemberExpression"===e?.callee?.type}function g(e,t){return function(e,t){return"CallExpression"===t?.type&&"Identifier"===t?.callee?.type&&t?.callee?.name===o(e)}(e,t)||function(e,t){return m(t)&&"Identifier"===t?.callee?.object?.type&&t?.callee?.object?.name===o(e)&&"Identifier"===t?.callee?.property?.type&&t?.callee?.property?.name===l(e)}(e,t)}const d=[];function y(e){try{if("BinaryExpression"!==e.type)return!0;if("+"!==e.operator)throw new Error("not a +");return y(e.left)&&y(e.right)}catch(e){return!1}}function b(e){const t=f(e),r={...s(e),...c(e)},n=Object.keys(r),i=u(e),a=Object.keys(i),l={...r,...i};function b(t,r,n){const i=l[r];return(function(e){return Array.isArray(e)&&3===e.length&&e.every((e=>"string"==typeof e))}(i)?function(t){return(r,n)=>t.map((t=>t.replace("__CONSTRUCT__",o(e)).replace("${L}",r).replace("${R}",n)))}(i):(e,t)=>[e,i,t])(t,n)}function h(e){const{type:t,value:r}=e||{};return"Literal"===t&&isNaN(r)}function $(e){return"MemberExpression"===e?.type&&"Identifier"===e?.property?.type&&"length"===e?.property?.name}return r=>{const i=n.includes(r.operator);if(i){const{left:e,right:t}=r;if(h(e)||h(t))return;if($(e)||$(t))return}const s=a.includes(r.operator);if(!i&&!s)return;const c=e.getSource(r);if(s&&!t){const t=o(e);return void e.report({node:r,message:`is '${c}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})}const u=p(e)&&y(r),l=function(e,t){let r=t;for(;!g(e,r);){if(!m(r))return!1;r=r.callee.object}return!0}(e,r.left);d.push({node:r,original:c,summable:u&&!l,report:{node:r,message:`is '${c}' a financial calculation?`,fix:t=>{const{operator:n,left:i,right:a}=r,s=e.getSource(i),c=e.getSource(a);return l?t.replaceText(r,function(e,t,r){const[,n,i]=b(e,t,r);return`${e}.${n}(${i})`}(s,n,c)):t.replaceText(r,function(e,t,r,n){const i=o(e),[a,s,c]=b(t,r,n);return`${i}(${a}).${s}(${c})`}(e,s,n,c))}}})}}function h(e,t){return"BinaryExpression"!==t.type?[e.getSource(t)]:[...h(e,t.left),...h(e,t.right)].flat()}function $(e,t){const r=h(e,t).join(", ");return`${o(e)}.${l(e)}(${r})`}function x(e){return t=>{if(r=t,!d.find((({node:e})=>e===r)))return;var r;const{node:n,original:i,summable:a,report:o}=d.pop();a?d.length&&d[d.length-1]?.summable||e.report({node:n,message:`is '${i}' a financial calculation?`,fix:t=>t.replaceText(n,$(e,n))}):e.report(o)}}var N={create:e=>({BinaryExpression:b(e),"BinaryExpression:exit":x(e)}),meta:{category:"Financial, Currency",description:"Replace JavaScript arithmetic with BigNumber methods",fixable:"code"}};const{makeSettingGetter:_,getConstruct:C}=i,v={">>=":"shiftedBy",">>>=":"shiftedBy","<<=":["${L}","shiftedBy","-${R}"]},O=_("assignment",{"+=":"plus","-=":"minus","/=":"dividedBy","*=":"multipliedBy","**=":"exponentiatedBy","%=":"modulo",...v}),S=_("supportsBitwise",!0);function T(e){const t=S(e),r=O(e),n=Object.keys(r),i=Object.keys(v);function a(t,n,i){const a=r[n];return(function(e){return Array.isArray(e)&&3===e.length&&e.every((e=>"string"==typeof e))}(a)?function(t){return(r,n)=>t.map((t=>t.replace("__CONSTRUCT__",C(e)).replace("${L}",r).replace("${R}",n)))}(a):(e,t)=>[e,a,t])(t,i)}return r=>{if(!n.includes(r.operator))return;const o=i.includes(r.operator),s=e.getSource(r);if(o&&!t){const t=C(e);return void e.report({node:r,message:`is '${s}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})}const c=C(e);"Identifier"!==r?.left?.type&&r?.left?.name===c||e.report({node:r,message:`is '${s}' a financial calculation?`,fix:t=>{const{operator:n,left:i,right:o}=r,s=e.getSource(i),c=e.getSource(o);return t.replaceText(r,function(e,t,r,n){const i=C(e),[o,s,c]=a(t,r,n);return`${o} = ${i}(${o}).${s}(${c})`}(e,s,n,c))}})}}var j,B={create:e=>({AssignmentExpression:T(e)}),meta:{category:"Financial, Currency",description:"Replace JavaScript assignment-expressions with BigNumber equivalents",fixable:"code"}},E={exports:{}};!function(e,t){var r=Object.defineProperty;((e,t)=>{for(var n in(e=>{r(e,"__esModule",{value:!0})})(e),t)r(e,n,{get:t[n],enumerable:!0})})(t,{against:()=>m,defined:()=>$,empty:()=>h,endsWith:()=>S,falsy:()=>B,gt:()=>x,gte:()=>_,inRange:()=>v,includes:()=>T,isArray:()=>o,isFunction:()=>s,isNumber:()=>c,isPojo:()=>p,isRegExp:()=>u,isString:()=>l,lt:()=>N,lte:()=>C,match:()=>f,otherwise:()=>g,spread:()=>E,startsWith:()=>O,truthy:()=>j,when:()=>d});var n=Object.prototype,i=n.toString,a=e=>typeof e,o=e=>Array.isArray(e),s=e=>"function"===a(e),c=e=>"number"===a(e),u=e=>e instanceof RegExp,l=e=>"string"===a(e),p=e=>!(null===e||!(e=>"object"===a(e)&&null!==e)(e)||(e=>"[object Arguments]"===i.call(e))(e))&&Object.getPrototypeOf(e)===n;function f(e){return(...t)=>m(...t)(e)}function m(...e){let t;return r=>e.find((e=>{let n=e(r),{matched:i,value:a}=n||{};return[i,a].every(s)?i(r)&&(t=a(r),!0):n&&(t=n)}))&&t}var g=e=>t=>({matched:()=>!0,value:()=>s(e)?e(t):e}),d=e=>t=>r=>({matched:()=>y(e,r),value:()=>s(t)?l(r)&&u(e)?t(r.match(e)):t(r):t}),y=(e,t)=>p(e)?Object.keys(e).every((r=>b(e[r],null==t?void 0:t[r]))):o(e)?o(t)?e.length===t.length&&e.every(((e,r)=>b(e,null==t?void 0:t[r]))):e.some((e=>y(e,t))):b(e,t),b=(e,t)=>p(e)||o(e)?y(e,t):s(e)?e(t):l(t)&&u(e)?e.test(t):e===t||[e,t].every(Number.isNaN),h=e=>e!=e||!e&&0!==e&&!1!==e||o(e)&&!e.length||p(e)&&!Object.keys(e).length,$=e=>!h(e),x=e=>A((t=>t>e)),N=e=>A((t=>t<e)),_=e=>A((t=>t>=e)),C=e=>A((t=>t<=e)),v=(e,t)=>A((r=>r>=e&&r<=t)),O=e=>R((t=>t.startsWith(e))),S=e=>R((t=>t.endsWith(e))),T=e=>function(e){return t=>(o(t)||l(t))&&e(t)}((t=>t.includes(e))),j=e=>!!e,B=e=>!e,E=e=>new Proxy({},{get:()=>e});function R(e){return t=>l(t)&&e(t)}function A(e){return t=>c(t)&&e(t)}}(0,E.exports),(j=E.exports)&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")&&j.default;const{match:R,when:A,otherwise:I}=E.exports,{getConstruct:w}=i;function k(e){return"Identifier"===e?.type&&"CallExpression"===e?.parent?.type&&e?.parent?.callee===e}function F(e){return(t,r)=>{if(k(r))return!1;const n=function(e){return"Identifier"!==e?.type&&"MemberExpression"!==e?.parent?.type?null:R(e?.parent?.object)(A({type:"Identifier"})((e=>e?.name)),A({type:"CallExpression"})((e=>e?.callee?.name)),I(null))}(r);if(null===n)return!1;return e.replace("__CONSTRUCT__",w(t))===n}}const M=F("__CONSTRUCT__");var U={IdentifierIsAlreadyBigNumberMethod:M,makeIdentifierMembershipDetector:F,makeGlobalIdentifierFixer:function(e){const t={},r=Object.keys(e).filter((e=>{if(e.includes(".")){const[r,n]=e.split(".");return t[n]=F(r),!1}return!0}));return n=>i=>{if(M(n,i))return;const a=n.getSource(i);if(r.includes(i.name)&&k(i))return void n.report({node:i,message:`is '${a}' a financial calculation?`,fix:t=>{const r=e[i.name];return t.replaceText(i,r(n))}});const o=t[i.name];"function"==typeof o&&o(n,i)&&n.report({node:i.parent,message:`is '${a}' a financial calculation?`,fix:t=>{const r=e[i.name];return t.replaceText(i.parent,r(n))}})}}};const{getConstruct:G}=i,{makeGlobalIdentifierFixer:P}=U,q=P({isNaN:e=>`${G(e)}.isNaN`,"Number.isNaN":e=>`${G(e)}.isNaN`});var D={create:e=>({Identifier:q(e)}),meta:{category:"Financial, Currency",description:"Replace isNaN with BigNumber equivalent",fixable:"code"}};const{makeSettingGetter:L,getConstruct:J}=i,W=L("math",{min:"minimum",max:"maximum",random:"random",abs:"absoluteValue",sign:["__CONSTRUCT__(${A}).comparedTo(0)"],sqrt:"squareRoot"});function V(e){const t=W(e),r=Object.keys(t);return n=>{const{callee:i}=n;if("MemberExpression"!==i.type)return;if("Math"!==i?.object?.name)return;const a=i?.property?.name;if(!r.includes(a))return;const o=e.getSource(n);e.report({node:n,message:`is '${o}' a financial calculation?`,fix:r=>r.replaceText(n,function(e,r,n){const i=t[n],a=r.arguments.map((t=>e.getSource(t))).join(", "),o=J(e);if(Array.isArray(i)){if(1===i.length)return i[0].replace("__CONSTRUCT__",o).replace("${A}",a);if(2===i.length)return`${o}.${i[0]}(${i.slice(1).map((e=>e.replace("${A}",a)))})`}return`${o}.${i}(${a})`}(e,n,a))})}}var H={create:e=>({CallExpression:V(e)}),meta:{category:"Financial, Currency",description:"Replace JavaScript Math methods with BigNumber equivalents",fixable:"code"}};const{makeSettingGetter:z,getConstruct:K}=i,{IdentifierIsAlreadyBigNumberMethod:Q}=U,X=z("number",{parseFloat:["__CONSTRUCT__(${A})"],toExponential:"toExponential",toFixed:"decimalPlaces",toPrecision:"toPrecision",toString:"toString"});function Y(e){const t=X(e),r=Object.keys(t);return n=>{const{callee:i}=n;if("MemberExpression"!==i.type)return;if("Identifier"!==i?.property?.type)return;const a=i?.property?.name;if(!r.includes(a))return;if(Q(e,i?.property))return;const o=e.getSource(n);e.report({node:n,message:`is '${o}' a financial calculation?`,fix:r=>r.replaceText(n,function(e,r,n){const i=t[n],a=r.arguments.map((t=>e.getSource(t))).join(", "),o=K(e),s=e.getSource(r?.callee?.object);return"Number"===r?.callee?.object?.name&&Array.isArray(i)&&1===i.length?i[0].replace("__CONSTRUCT__",o).replace("${O}",s).replace("${A}",a):`${o}(${s}).${i}(${a})`}(e,n,a))})}}var Z={create:e=>({CallExpression:Y(e)}),meta:{category:"Financial, Currency",description:"Replace JavaScript Number.prototype methods with BigNumber equivalents",fixable:"code"}};const{getConstruct:ee}=i,{makeGlobalIdentifierFixer:te}=U,re=te({parseFloat:e=>ee(e)});var ne={create:e=>({Identifier:re(e)}),meta:{category:"Financial, Currency",description:"Replace parseFloat with BigNumber equivalent",fixable:"code"}};const{makeSettingGetter:ie,getConstruct:ae}=i,oe={floor:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_FLOOR\n})",ceil:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_CEIL\n})",round:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_HALF_EVEN\n})"},se=ie("supportsRound",!1),ce=ie("rounding",oe);function ue(e){const t=Object.keys(oe),r=ce(e),n=se(e);return i=>{const{callee:a}=i;if("MemberExpression"!==a.type)return;if("Math"!==a?.object?.name)return;const o=a?.property?.name;if(!t.includes(o))return;const s=e.getSource(i);n?e.report({node:i,message:`is '${s}' a financial calculation?`,fix:t=>t.replaceText(i,function(e,t,n){const i=r[n],a=t.arguments.map((t=>e.getSource(t))).join(", "),o=ae(e);if(Array.isArray(i)){if(1===i.length)return i[0].replace("__CONSTRUCT__",o).replace("${A}",a);if(2===i.length)return`${o}.${i[0]}(${i.slice(1).map((e=>e.replace("${A}",a)))})`}return`${o}.${i}(${a})`}(e,i,o))}):e.report({node:i,message:`is '${s}' a financial calculation? If so, use the global constructor setting:\n\n${r[o]}\n`})}}function le(e){const t=ce(e),r=se(e);return n=>{if("~"!==n?.operator)return;if("~"!==n?.argument?.operator)return;const i=e.getSource(n);r?e.report({node:n,message:`is '${i}' a financial calculation?`,fix:r=>r.replaceText(n,function(e,r){const n=t.floor,i=e.getSource(r?.argument?.argument),a=ae(e);if(Array.isArray(n)){if(1===n.length)return n[0].replace("__CONSTRUCT__",a).replace("${A}",i);if(2===n.length)return`${a}.${n[0]}(${n.slice(1).map((e=>e.replace("${A}",i)))})`}return`${a}.${n}(${i})`}(e,n))}):e.report({node:n,message:`is '${i}' a financial calculation? If so, use the global constructor setting:\n\n${t.floor}\n`})}}var pe={rules:{arithmetic:N,assignment:B,isNaN:D,math:H,number:Z,parseFloat:ne,rounding:{create:e=>({CallExpression:ue(e),UnaryExpression:le(e)}),meta:{category:"Financial, Currency",description:"Warn against using JavaScript Math.round|ceil|floor methods, or offer replacements",fixable:"code"}}},configs:{recommended:{rules:{"big-number-rules/arithmetic":"warn","big-number-rules/assignment":"warn","big-number-rules/isNaN":"warn","big-number-rules/math":"warn","big-number-rules/number":"warn","big-number-rules/parseFloat":"warn","big-number-rules/rounding":"warn"}}}};module.exports=pe;
