/*
 * eslint-plugin-big-number-rules
 * v1.7.5
 * https://github.com/shuckster/eslint-plugin-big-number-rules
 * License: MIT
 */
"use strict";var e,t={exports:{}};!function(e,t){var r=Object.defineProperty;((e,t)=>{for(var n in(e=>{r(e,"__esModule",{value:!0})})(e),t)r(e,n,{get:t[n],enumerable:!0})})(t,{against:()=>f,allOf:()=>_,anyOf:()=>$,defined:()=>E,empty:()=>N,endsWith:()=>T,falsy:()=>D,gt:()=>O,gte:()=>S,hasOwn:()=>j,inRange:()=>I,includedIn:()=>R,includes:()=>B,instanceOf:()=>o,isArray:()=>s,isFunction:()=>c,isNumber:()=>u,isPojo:()=>m,isRegExp:()=>p,isString:()=>l,lt:()=>C,lte:()=>w,match:()=>g,not:()=>x,otherwise:()=>d,pluck:()=>b,spread:()=>F,startsWith:()=>v,truthy:()=>A,when:()=>y});var n=Object.prototype,i=n.toString,a=e=>t=>typeof t===e,o=e=>t=>t instanceof e,s=Array.isArray,c=a("function"),l=a("string"),u=e=>e==e&&a("number")(e),p=o(RegExp),m=e=>!(null===e||!(e=>null!==e&&a("object")(e))(e)||(e=>"[object Arguments]"===i.call(e))(e))&&Object.getPrototypeOf(e)===n;function g(e){return(...t)=>f(...t)(e)}var f=(...e)=>{let t;return r=>e.find((e=>{let n=e(r),{matched:i,value:a}=n||{};return[i,a].every(c)?i(r)&&(t=a(r),!0):n&&(t=n)}))&&t},d=e=>t=>({matched:()=>!0,value:()=>c(e)?e(t):e}),y=e=>t=>r=>({matched:()=>h(e,r,(e=>r=e)),value:()=>c(t)?l(r)&&p(e)?t(r.match(e)):t(r):t}),h=(e,t,r)=>m(e)?Object.keys(e).every((n=>h(e[n],null==t?void 0:t[n],r))):s(e)?s(t)?e.length===t.length&&e.every(((e,n)=>h(e,null==t?void 0:t[n],r))):e.some((e=>h(e,t,r))):c(e)?e(t,r):l(t)&&p(e)?e.test(t):e===t||[e,t].every(Number.isNaN),b=(...e)=>(t,r)=>!(0!==e.length&&!(c(e[0])?e[0](t):h(e[0],t,r)))&&(r(t),!0),x=e=>(t,r)=>!h(e,t,r),$=(...e)=>e.flat(),_=(...e)=>(t,r)=>e.flat().every((e=>h(e,t,r))),N=e=>e!=e||!e&&0!==e&&!1!==e||s(e)&&!e.length||m(e)&&!Object.keys(e).length,E=e=>!N(e),O=e=>M((t=>t>e)),C=e=>M((t=>t<e)),S=e=>M((t=>t>=e)),w=e=>M((t=>t<=e)),I=(e,t)=>M((r=>r>=e&&r<=t)),v=e=>k((t=>t.startsWith(e))),T=e=>k((t=>t.endsWith(e))),B=e=>G((t=>t.includes(e))),R=$,j=(...e)=>t=>m(t)&&(([e,t])=>e.length&&e.every((e=>t.includes(e))))([e.flat(),Object.keys(t)]),A=e=>!!e,D=e=>!e,F=e=>new Proxy({},{get:()=>e}),k=e=>t=>l(t)&&e(t),M=e=>t=>u(t)&&e(t),G=e=>t=>(s(t)||l(t))&&e(t)}(0,t.exports),(e=t.exports)&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")&&e.default;const{isPojo:r}=t.exports;function n(e="construct",t="BigNumber"){return n=>{const{settings:i}=n,a=i["big-number-rules"]?.[e]??t;return r(t)&&r(a)&&t!==a?{...t,...a}:a}}const i=n("construct","BigNumber"),a=n("importDeclaration","__IGNORE__");var o={makeSettingGetter:n,isPojo:r,getConstruct:i,getImportDeclaration:a};const{match:s,when:c,otherwise:l,isString:u,anyOf:p}=t.exports,{getConstruct:m,getImportDeclaration:g}=o;function f(e){return"Identifier"===e?.type&&"CallExpression"===e?.parent?.type&&e?.parent?.callee===e}function d(e){return(t,r)=>{if(f(r))return!1;const n=function(e){return s(e)(c({type:"Identifier",parent:{type:"MemberExpression",object:p({type:"Identifier",name:u},{type:"CallExpression",callee:{name:u}})}})((({parent:{object:e}})=>s(e)(c({type:"Identifier"})((e=>e.name)),c({type:"CallExpression"})((e=>e.callee.name)),l(null)))),l(null))}(r);if(null===n)return!1;return e.replace("__CONSTRUCT__",m(t))===n}}const y=d("__CONSTRUCT__");var h={IdentifierIsAlreadyBigNumberMethod:y,makeIdentifierMembershipDetector:d,makeGlobalIdentifierFixer:function(e){const t={},r=[];return Object.keys(e).forEach((e=>{if(e.includes(".")){const[r,n]=e.split(".");t[n]=d(r)}else r.push(e)})),n=>i=>{if(y(n,i))return;const a=n.getSource(i);if(r.includes(i.name)&&f(i))return void n.report({node:i,message:`is '${a}' a financial calculation?`,fix:t=>{const r=e[i.name];return t.replaceText(i,r(n))}});const o=t[i.name];"function"==typeof o&&o(n,i)&&n.report({node:i.parent,message:`is '${a}' a financial calculation?`,fix:t=>{const r=e[i.name];return t.replaceText(i.parent,r(n))}})}},withImportDeclaration:function(e,t){const r=g(e);return"__IGNORE__"===r?t:n=>{const[i]=e.getAncestors(),a=i?.body?.find((e=>"ImportDeclaration"===e?.type&&e?.source?.value===r));if(a)return t(n)}},StringFromArguments:function(e){return t=>t.arguments.map((t=>e.getSource(t))).join(", ")}};const{match:b,when:x,against:$,otherwise:_,not:N,allOf:E}=t.exports,{makeSettingGetter:O,getConstruct:C}=o,{withImportDeclaration:S}=h,w=e=>Array.isArray(e)&&[3,4].includes(e.length),I=O("arithmetic",{"+":"plus","-":"minus","/":"dividedBy","*":"multipliedBy","**":"exponentiatedBy","%":"modulo"}),v=O("comparison",{"<":"isLessThan","<=":"isLessThanOrEqualTo","===":"isEqualTo","==":"isEqualTo","!==":["__NEGATION__","${L}","isEqualTo","${R}"],"!=":["__NEGATION__","${L}","isEqualTo","${R}"],">=":"isGreaterThanOrEqualTo",">":"isGreaterThan"}),T=O("bitwise",{">>":"shiftedBy",">>>":"shiftedBy","<<":["${L}","shiftedBy","-${R}"]}),B=O("sum","sum"),R=O("supportsSum",!0),j=O("supportsBitwise",!0),A=[];function D(e){const t=C(e),r=j(e),n={...I(e),...v(e)},i=Object.keys(n),a=T(e),o=Object.keys(a),s={...n,...a},c=N(E(q,L)),l=u;return $(x({type:"BinaryExpression",operator:i,left:c,right:c})(l),x({type:"BinaryExpression",operator:o,left:c,right:c})((function(n){if(r)return u(n);const i=e.getSource(n);e.report({node:n,message:`is '${i}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})})));function u(r){const n=e.getSource(r),i=R(e)&&k(r),a=function(e,t){let r=t;for(;!U(e,r);){if(!G(r))return!1;r=r.callee.object}return!0}(e,r.left);A.push({node:r,original:n,summable:i&&!a,report:{node:r,message:`is '${n}' a financial calculation?`,fix:n=>{const{operator:i}=r,o=e.getSource(r.left),c=e.getSource(r.right),[l,u,p,m]=b(s[i])(x(w)((e=>{const r=e.map((e=>e.replace("__CONSTRUCT__",t).replace("${L}",o).replace("${R}",c)));3===r.length&&r.unshift("");const[n,...i]=r;return["__NEGATION__"===n,...i]})),_((e=>["",o,e,c]))),g=l?"!":"";return n.replaceText(r,a?`${g}${o}.${p}(${m})`:`${g}${t}(${u}).${p}(${m})`)}}})}}function F(e){return t=>{if(r=t,!A.find((({node:e})=>e===r)))return;var r;const{node:n,original:i,summable:a,report:o}=A.pop();a?function(){if(!A.length)return!1;return A[A.length-1]?.summable??!1}()||e.report({node:n,message:`is '${i}' a financial calculation?`,fix:t=>{const r=M(e,n).join(", ");return t.replaceText(n,`${C(e)}.${B(e)}(${r})`)}}):e.report(o)}}function k(e){try{if("BinaryExpression"!==e.type)return!0;if("+"!==e.operator)throw new Error("not a +");return k(e.left)&&k(e.right)}catch(e){return!1}}function M(e,t){return"BinaryExpression"!==t.type?[e.getSource(t)]:[...M(e,t.left),...M(e,t.right)].flat()}function G(e){return"CallExpression"===e?.type&&"MemberExpression"===e?.callee?.type}function U(e,t){return function(e,t){return"CallExpression"===t?.type&&"Identifier"===t?.callee?.type&&t?.callee?.name===C(e)}(e,t)||function(e,t){return G(t)&&"Identifier"===t?.callee?.object?.type&&t?.callee?.object?.name===C(e)&&"Identifier"===t?.callee?.property?.type&&t?.callee?.property?.name===B(e)}(e,t)}function q(e){const{type:t,value:r}=e||{};return"Literal"===t&&isNaN(r)}function L(e){return"MemberExpression"===e?.type&&"Identifier"===e?.property?.type&&"length"===e?.property?.name}var P={create:e=>({BinaryExpression:S(e,D(e)),"BinaryExpression:exit":S(e,F(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript arithmetic with BigNumber methods",fixable:"code"}};const{against:J,when:W,not:V,match:H,otherwise:z}=t.exports,{makeSettingGetter:K,getConstruct:Q}=o,{withImportDeclaration:X}=h,Y={"+=":"plus","-=":"minus","/=":"dividedBy","*=":"multipliedBy","**=":"exponentiatedBy","%=":"modulo"},Z={">>=":"shiftedBy",">>>=":"shiftedBy","<<=":["${L}","shiftedBy","-${R}"]},ee=e=>Array.isArray(e)&&3===e.length,te=K("assignment",{...Y,...Z}),re=K("supportsBitwise",!0);function ne(e){const t=Q(e),r=te(e),n=Object.keys(Y),i=Object.keys(Z),a=re(e),o=V({type:"Identifier",name:t}),s=c;return J(W({type:"AssignmentExpression",operator:n,left:o})(s),W({type:"AssignmentExpression",operator:i,left:o})((function(r){if(a)return c(r);const n=e.getSource(r);e.report({node:r,message:`is '${n}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})})));function c(n){const i=e.getSource(n);e.report({node:n,message:`is '${i}' a financial calculation?`,fix:i=>{const a=e.getSource(n.left),o=e.getSource(n.right),[s,c,l]=H(r[n.operator])(W(ee)((e=>e.map((e=>e.replace("__CONSTRUCT__",t).replace("${L}",a).replace("${R}",o))))),z((e=>[a,e,o])));return i.replaceText(n,`${s} = ${t}(${s}).${c}(${l})`)}})}}var ie={create:e=>({AssignmentExpression:X(e,ne(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript assignment-expressions with BigNumber equivalents",fixable:"code"}};const{against:ae,when:oe}=t.exports,{getConstruct:se}=o,{withImportDeclaration:ce,StringFromArguments:le}=h;function ue(e){return ae(oe({type:"CallExpression",callee:{type:"Identifier",name:"isNaN"}})(t),oe({type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"Number"},property:{type:"Identifier",name:"isNaN"}}})(t));function t(t){const r=e.getSource(t);e.report({node:t,message:`is '${r}' a financial calculation?`,fix:r=>{const n=se(e),i=le(e)(t);return r.replaceText(t,`${n}(${i}).isNaN()`)}})}}var pe={create:e=>({CallExpression:ce(e,ue(e))}),meta:{category:"Financial, Currency",description:"Replace isNaN with BigNumber equivalent",fixable:"code"}};const{match:me,when:ge,against:fe,otherwise:de}=t.exports,{makeSettingGetter:ye,getConstruct:he}=o,{withImportDeclaration:be,StringFromArguments:xe}=h,$e=ye("math",{min:"minimum",max:"maximum",random:"random",abs:"absoluteValue",sign:["__CONSTRUCT__(${A}).comparedTo(0)"],sqrt:"squareRoot"});function _e(e){const t=$e(e),r=Object.keys(t);return fe(ge({type:"CallExpression",callee:{type:"MemberExpression",object:{name:"Math"},property:{name:r}}})((function(r){const n=e.getSource(r);e.report({node:r,message:`is '${n}' a financial calculation?`,fix:n=>{const i=he(e),a=r.callee.property.name,o=xe(e)(r);return n.replaceText(r,me(t[a])(ge({length:1})((e=>e[0].replace("__CONSTRUCT__",i).replace("${A}",o))),ge({length:2})((e=>{const t=e[0],r=e.slice(1).map((e=>e.replace("${A}",o)));return`${i}.${t}(${r})`})),de((e=>`${i}.${e}(${o})`))))}})})))}var Ne={create:e=>({CallExpression:be(e,_e(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript Math methods with BigNumber equivalents",fixable:"code"}};const{match:Ee,when:Oe,against:Ce,otherwise:Se}=t.exports,{makeSettingGetter:we,getConstruct:Ie}=o,{IdentifierIsAlreadyBigNumberMethod:ve,withImportDeclaration:Te,StringFromArguments:Be}=h,Re=we("number",{parseFloat:["__CONSTRUCT__(${A})"],toExponential:"toExponential",toFixed:"decimalPlaces",toPrecision:"toPrecision",toString:"toString"});function je(e){const t=Re(e),r=Object.keys(t);return Ce(Oe({type:"CallExpression",callee:{type:"MemberExpression",property:{type:"Identifier",name:r}}})((function(r){const{property:n,object:i}=r.callee;if(ve(e,n))return;const a=e.getSource(r);e.report({node:r,message:`is '${a}' a financial calculation?`,fix:a=>{const o=Ie(e),s=e.getSource(i),c=Be(e)(r);return a.replaceText(r,Ee({node:r,method:t[n.name]})(Oe({node:{callee:{object:{name:"Number"}}},method:Array.isArray})((({method:e})=>e[0].replace("__CONSTRUCT__",o).replace("${O}",s).replace("${A}",c))),Se((({method:e})=>`${o}(${s}).${e}(${c})`))))}})})))}var Ae={create:e=>({CallExpression:Te(e,je(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript Number.prototype methods with BigNumber equivalents",fixable:"code"}};const{getConstruct:De}=o,{makeGlobalIdentifierFixer:Fe,withImportDeclaration:ke}=h,Me=Fe({parseFloat:e=>De(e)});var Ge={create:e=>({Identifier:ke(e,Me(e))}),meta:{category:"Financial, Currency",description:"Replace parseFloat with BigNumber equivalent",fixable:"code"}};const{against:Ue,when:qe,match:Le,otherwise:Pe}=t.exports,{makeSettingGetter:Je,getConstruct:We}=o,{withImportDeclaration:Ve}=h,He={floor:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_FLOOR\n})",ceil:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_CEIL\n})",round:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_HALF_EVEN\n})"},ze=Je("supportsRound",!1),Ke=Je("rounding",He);function Qe(e){const t=Object.keys(He),r=Ke(e),n=ze(e);return Ue(qe({type:"CallExpression",callee:{type:"MemberExpression",object:{name:"Math"},property:{name:t}}})((function(t){const i=e.getSource(t),a=t.callee.property.name;if(!n)return void e.report({node:t,message:`is '${i}' a financial calculation? If so, use the global constructor setting:\n\n${r[a]}\n`});e.report({node:t,message:`is '${i}' a financial calculation?`,fix:n=>{const i=We(e),o=r[a],s=t.arguments.map((t=>e.getSource(t))).join(", ");return n.replaceText(t,Le(o)(qe({length:1})((e=>e[0].replace("__CONSTRUCT__",i).replace("${A}",s))),qe({length:2})((e=>{const t=e[0],r=e.slice(1).map((e=>e.replace("${A}",s)));return`${i}.${t}(${r})`})),Pe((e=>`${i}.${e}(${s})`))))}})})))}function Xe(e){const t=Ke(e),r=ze(e);return Ue(qe({type:"UnaryExpression",operator:"~",argument:{operator:"~"}})((function(n){const i=e.getSource(n),a=t.floor;if(!r)return void e.report({node:n,message:`is '${i}' a financial calculation? If so, use the global constructor setting:\n\n${a}\n`});e.report({node:n,message:`is '${i}' a financial calculation?`,fix:t=>{const r=e.getSource(n?.argument?.argument),i=We(e);return t.replaceText(n,Le(a)(qe({length:1})((e=>e[0].replace("__CONSTRUCT__",i).replace("${A}",r))),qe({length:2})((e=>{const t=e[0],n=e.slice(1).map((e=>e.replace("${A}",r)));return`${i}.${t}(${n})`})),Pe((e=>`${i}.${e}(${r})`))))}})})))}var Ye={rules:{arithmetic:P,assignment:ie,isNaN:pe,math:Ne,number:Ae,parseFloat:Ge,rounding:{create:e=>({CallExpression:Ve(e,Qe(e)),UnaryExpression:Ve(e,Xe(e))}),meta:{category:"Financial, Currency",description:"Warn against using JavaScript Math.round|ceil|floor methods, or offer replacements",fixable:"code"}}},configs:{recommended:{rules:{"big-number-rules/arithmetic":"warn","big-number-rules/assignment":"warn","big-number-rules/isNaN":"warn","big-number-rules/math":"warn","big-number-rules/number":"warn","big-number-rules/parseFloat":"warn","big-number-rules/rounding":"warn"}}}};module.exports=Ye;
