/*
 * eslint-plugin-big-number-rules
 * v1.7.8
 * https://github.com/shuckster/eslint-plugin-big-number-rules
 * License: MIT
 */
"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,r)=>{for(var n in r)e(t,n,{get:r[n],enumerable:!0})},s={};o(s,{against:()=>A,allOf:()=>q,anyOf:()=>P,cata:()=>te,defined:()=>J,empty:()=>L,endsWith:()=>X,falsy:()=>ne,gt:()=>W,gte:()=>H,hasOwn:()=>ee,inRange:()=>K,includedIn:()=>Z,includes:()=>Y,instanceOf:()=>T,isArray:()=>E,isDate:()=>S,isFunction:()=>w,isNumber:()=>C,isPojo:()=>v,isRegExp:()=>I,isString:()=>j,lt:()=>V,lte:()=>z,match:()=>R,not:()=>U,otherwise:()=>B,pluck:()=>G,spread:()=>ae,startsWith:()=>Q,truthy:()=>re,when:()=>F});var c,l=(c=s,((n,i,o,s)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let c of r(i))!a.call(n,c)&&c!==o&&e(n,c,{get:()=>i[c],enumerable:!(s=t(i,c))||s.enumerable});return n})(e({},"__esModule",{value:!0}),c)),u={};o(u,{instanceOf:()=>f,isArguments:()=>d,isArray:()=>y,isDate:()=>h,isFunction:()=>b,isNumber:()=>x,isObject:()=>O,isPojo:()=>_,isRegExp:()=>N,isString:()=>$});var p=Object.prototype,m=p.toString,g=e=>t=>typeof t===e,f=e=>t=>t instanceof e,{isArray:y}=Array,d=e=>"[object Arguments]"===m.call(e),h=e=>f(Date)(e)&&!isNaN(e),b=g("function"),$=g("string"),x=e=>e==e&&g("number")(e),O=e=>null!==e&&g("object")(e),N=f(RegExp),_=e=>!(null===e||!O(e)||d(e))&&Object.getPrototypeOf(e)===p,{isArray:E,isDate:S,isFunction:w,isNumber:C}=u,{isPojo:v,isRegExp:I,isString:j,instanceOf:T}=u;function R(e){return(...t)=>A(...t)(e)}var A=(...e)=>{let t;return r=>e.find((e=>{let n=e(r),{matched:a,value:i}=n||{};return[a,i].every(w)?a(r)&&(t=i(r),!0):n&&(t=n)}))&&t},B=e=>t=>({matched:()=>!0,value:()=>w(e)?e(t):e}),D=e=>t=>r=>({matched:()=>M(e,r,(e=>r=e)),value:()=>w(t)?j(r)&&I(e)?t(...k(r.match(e))):t(r):t}),F=(...e)=>{if(1===e.length){let[t]=e;return D(t)}if(2===e.length){let[t,r]=e;return D(t)(r)}throw new Error("expected 1 or 2 arguments")},k=e=>{let{groups:t}=e;return t?[t,e]:[e]},M=(e,t,r)=>v(e)?Object.keys(e).every((n=>M(e[n],null==t?void 0:t[n],r))):E(e)?E(t)&&e.length===t.length&&e.every(((e,n)=>M(e,null==t?void 0:t[n],r))):w(e)?e(t,r):j(t)&&I(e)?e.test(t):e===t||[e,t].every(Number.isNaN),G=(...e)=>(t,r)=>!(0!==e.length&&!(w(e[0])?e[0](t):M(e[0],t,r)))&&(r(t),!0),U=e=>(t,r)=>!M(e,t,r),P=(...e)=>(t,r)=>e.flat().some((e=>M(e,t,r))),q=(...e)=>(t,r)=>e.flat().every((e=>M(e,t,r))),L=e=>e!=e||!e&&0!==e&&!1!==e||E(e)&&!e.length||v(e)&&!Object.keys(e).length,J=e=>!L(e),W=e=>oe((t=>t>e)),V=e=>oe((t=>t<e)),H=e=>oe((t=>t>=e)),z=e=>oe((t=>t<=e)),K=(e,t)=>oe((r=>r>=Math.min(e,t)&&r<=Math.max(e,t))),Q=e=>ie((t=>t.startsWith(e))),X=e=>ie((t=>t.endsWith(e))),Y=e=>se((t=>t.includes(e))),Z=P,ee=(...e)=>t=>v(t)&&(([e,t])=>e.length&&e.every((e=>t.includes(e))))([e.flat(),Object.keys(t)]),te=e=>{var t=e,{getValue:r}=t,o=((e,t)=>{var r={};for(var o in e)a.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&i.call(e,o)&&(r[o]=e[o]);return r})(t,["getValue"]);return Object.entries(o).reduce(((e,[t,n])=>Object.assign(e,{[t]:e=>t=>({matched:()=>n(t),value:()=>w(e)?e(r(t)):e})})),{})},re=e=>!!e,ne=e=>!e,ae=e=>new Proxy({},{get:()=>e}),ie=e=>t=>j(t)&&e(t),oe=e=>t=>C(t)&&e(t),se=e=>t=>(E(t)||j(t))&&e(t);const{isPojo:ce}=l;function le(e="construct",t="BigNumber"){return r=>{const{settings:n}=r,a=n["big-number-rules"]?.[e]??t;return ce(t)&&ce(a)&&t!==a?{...t,...a}:a}}const ue=le("construct","BigNumber"),pe=le("importDeclaration","__IGNORE__");var me={makeSettingGetter:le,isPojo:ce,getConstruct:ue,getImportDeclaration:pe};const{match:ge,when:fe,otherwise:ye,isString:de,anyOf:he}=l,{getConstruct:be,getImportDeclaration:$e}=me;function xe(e){return"Identifier"===e?.type&&"CallExpression"===e?.parent?.type&&e?.parent?.callee===e}function Oe(e){return(t,r)=>{if(xe(r))return!1;const n=function(e){return ge(e)(fe({type:"Identifier",parent:{type:"MemberExpression",object:he({type:"Identifier",name:de},{type:"CallExpression",callee:{name:de}})}})((({parent:{object:e}})=>ge(e)(fe({type:"Identifier"})((e=>e.name)),fe({type:"CallExpression"})((e=>e.callee.name)),ye(null)))),ye(null))}(r);if(null===n)return!1;return e.replace("__CONSTRUCT__",be(t))===n}}const Ne=Oe("__CONSTRUCT__");var _e={IdentifierIsAlreadyBigNumberMethod:Ne,makeIdentifierMembershipDetector:Oe,makeGlobalIdentifierFixer:function(e){const t={},r=[];return Object.keys(e).forEach((e=>{if(e.includes(".")){const[r,n]=e.split(".");t[n]=Oe(r)}else r.push(e)})),n=>a=>{if(Ne(n,a))return;const i=n.getSource(a);if(r.includes(a.name)&&xe(a))return void n.report({node:a,message:`is '${i}' a financial calculation?`,fix:t=>{const r=e[a.name];return t.replaceText(a,r(n))}});const o=(s=t,c=a.name,Object.prototype.hasOwnProperty.call(s,c)&&t[a.name]);var s,c;"function"==typeof o&&o(n,a)&&n.report({node:a.parent,message:`is '${i}' a financial calculation?`,fix:t=>{const r=e[a.name];return t.replaceText(a.parent,r(n))}})}},withImportDeclaration:function(e,t){const r=$e(e);return"__IGNORE__"===r?t:n=>{const[a]=e.getAncestors(),i=a?.body?.find((e=>"ImportDeclaration"===e?.type&&e?.source?.value===r));if(i)return t(n)}},StringFromArguments:function(e){return t=>t.arguments.map((t=>e.getSource(t))).join(", ")}};const{match:Ee,when:Se,against:we,otherwise:Ce,not:ve,allOf:Ie,anyOf:je}=l,{makeSettingGetter:Te,getConstruct:Re}=me,{withImportDeclaration:Ae}=_e,Be=e=>Array.isArray(e)&&[3,4].includes(e.length),De=Te("arithmetic",{"+":"plus","-":"minus","/":"dividedBy","*":"multipliedBy","**":"exponentiatedBy","%":"modulo"}),Fe=Te("comparison",{"<":"isLessThan","<=":"isLessThanOrEqualTo","===":"isEqualTo","==":"isEqualTo","!==":["__NEGATION__","${L}","isEqualTo","${R}"],"!=":["__NEGATION__","${L}","isEqualTo","${R}"],">=":"isGreaterThanOrEqualTo",">":"isGreaterThan"}),ke=Te("bitwise",{">>":"shiftedBy",">>>":"shiftedBy","<<":["${L}","shiftedBy","-${R}"]}),Me=Te("sum","sum"),Ge=Te("supportsSum",!0),Ue=Te("supportsBitwise",!0),Pe=[];function qe(e){const t=Re(e),r=Ue(e),n={...De(e),...Fe(e)},a=je(Object.keys(n)),i=ke(e),o=je(Object.keys(i)),s={...n,...i},c=ve(Ie(ze,Ke)),l=u;return we(Se({type:"BinaryExpression",operator:a,left:c,right:c})(l),Se({type:"BinaryExpression",operator:o,left:c,right:c})((function(n){if(r)return u(n);const a=e.getSource(n);e.report({node:n,message:`is '${a}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})})));function u(r){const n=e.getSource(r),a=Ge(e)&&Je(r),i=function(e,t){let r=t;for(;!He(e,r);){if(!Ve(r))return!1;r=r.callee.object}return!0}(e,r.left);Pe.push({node:r,original:n,summable:a&&!i,report:{node:r,message:`is '${n}' a financial calculation?`,fix:n=>{const{operator:a}=r,o=e.getSource(r.left),c=e.getSource(r.right),[l,u,p,m]=Ee(s[a])(Se(Be)((e=>{const r=e.map((e=>e.replace("__CONSTRUCT__",t).replace("${L}",o).replace("${R}",c)));3===r.length&&r.unshift("");const[n,...a]=r;return["__NEGATION__"===n,...a]})),Ce((e=>["",o,e,c]))),g=l?"!":"";return n.replaceText(r,i?`${g}${o}.${p}(${m})`:`${g}${t}(${u}).${p}(${m})`)}}})}}function Le(e){return t=>{if(r=t,!Pe.find((({node:e})=>e===r)))return;var r;const{node:n,original:a,summable:i,report:o}=Pe.pop();i?function(){if(!Pe.length)return!1;return Pe[Pe.length-1]?.summable??!1}()||e.report({node:n,message:`is '${a}' a financial calculation?`,fix:t=>{const r=We(e,n).join(", ");return t.replaceText(n,`${Re(e)}.${Me(e)}(${r})`)}}):e.report(o)}}function Je(e){try{if("BinaryExpression"!==e.type)return!0;if("+"!==e.operator)throw new Error("not a +");return Je(e.left)&&Je(e.right)}catch(e){return!1}}function We(e,t){return"BinaryExpression"!==t.type?[e.getSource(t)]:[...We(e,t.left),...We(e,t.right)].flat()}function Ve(e){return"CallExpression"===e?.type&&"MemberExpression"===e?.callee?.type}function He(e,t){return function(e,t){return"CallExpression"===t?.type&&"Identifier"===t?.callee?.type&&t?.callee?.name===Re(e)}(e,t)||function(e,t){return Ve(t)&&"Identifier"===t?.callee?.object?.type&&t?.callee?.object?.name===Re(e)&&"Identifier"===t?.callee?.property?.type&&t?.callee?.property?.name===Me(e)}(e,t)}function ze(e){const{type:t,value:r}=e||{};return"Literal"===t&&isNaN(r)}function Ke(e){return"MemberExpression"===e?.type&&"Identifier"===e?.property?.type&&"length"===e?.property?.name}var Qe={create:e=>({BinaryExpression:Ae(e,qe(e)),"BinaryExpression:exit":Ae(e,Le(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript arithmetic with BigNumber methods",fixable:"code"}};const{against:Xe,when:Ye,not:Ze,match:et,otherwise:tt,anyOf:rt}=l,{makeSettingGetter:nt,getConstruct:at}=me,{withImportDeclaration:it}=_e,ot={"+=":"plus","-=":"minus","/=":"dividedBy","*=":"multipliedBy","**=":"exponentiatedBy","%=":"modulo"},st={">>=":"shiftedBy",">>>=":"shiftedBy","<<=":["${L}","shiftedBy","-${R}"]},ct=e=>Array.isArray(e)&&3===e.length,lt=nt("assignment",{...ot,...st}),ut=nt("supportsBitwise",!0);function pt(e){const t=at(e),r=lt(e),n=rt(Object.keys(ot)),a=rt(Object.keys(st)),i=ut(e),o=Ze({type:"Identifier",name:t}),s=c;return Xe(Ye({type:"AssignmentExpression",operator:n,left:o})(s),Ye({type:"AssignmentExpression",operator:a,left:o})((function(r){if(i)return c(r);const n=e.getSource(r);e.report({node:r,message:`is '${n}' a financial calculation? If so, bitwise methods are not supported by ${t}\n`})})));function c(n){const a=e.getSource(n);e.report({node:n,message:`is '${a}' a financial calculation?`,fix:a=>{const i=e.getSource(n.left),o=e.getSource(n.right),[s,c,l]=et(r[n.operator])(Ye(ct)((e=>e.map((e=>e.replace("__CONSTRUCT__",t).replace("${L}",i).replace("${R}",o))))),tt((e=>[i,e,o])));return a.replaceText(n,`${s} = ${t}(${s}).${c}(${l})`)}})}}var mt={create:e=>({AssignmentExpression:it(e,pt(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript assignment-expressions with BigNumber equivalents",fixable:"code"}};const{against:gt,when:ft}=l,{getConstruct:yt}=me,{withImportDeclaration:dt,StringFromArguments:ht}=_e;function bt(e){return gt(ft({type:"CallExpression",callee:{type:"Identifier",name:"isNaN"}})(t),ft({type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"Number"},property:{type:"Identifier",name:"isNaN"}}})(t));function t(t){const r=e.getSource(t);e.report({node:t,message:`is '${r}' a financial calculation?`,fix:r=>{const n=yt(e),a=ht(e)(t);return r.replaceText(t,`${n}(${a}).isNaN()`)}})}}var $t={create:e=>({CallExpression:dt(e,bt(e))}),meta:{category:"Financial, Currency",description:"Replace isNaN with BigNumber equivalent",fixable:"code"}};const{match:xt,when:Ot,against:Nt,otherwise:_t,anyOf:Et}=l,{makeSettingGetter:St,getConstruct:wt}=me,{withImportDeclaration:Ct,StringFromArguments:vt}=_e,It=St("math",{min:"minimum",max:"maximum",random:"random",abs:"absoluteValue",sign:["__CONSTRUCT__(${A}).comparedTo(0)"],sqrt:"squareRoot"});function jt(e){const t=It(e),r=Et(Object.keys(t));return Nt(Ot({type:"CallExpression",callee:{type:"MemberExpression",object:{name:"Math"},property:{name:r}}})((function(r){const n=e.getSource(r);e.report({node:r,message:`is '${n}' a financial calculation?`,fix:n=>{const a=wt(e),i=r.callee.property.name,o=vt(e)(r);return n.replaceText(r,xt(t[i])(Ot({length:1})((e=>e[0].replace("__CONSTRUCT__",a).replace("${A}",o))),Ot({length:2})((e=>{const t=e[0],r=e.slice(1).map((e=>e.replace("${A}",o)));return`${a}.${t}(${r})`})),_t((e=>`${a}.${e}(${o})`))))}})})))}var Tt={create:e=>({CallExpression:Ct(e,jt(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript Math methods with BigNumber equivalents",fixable:"code"}};const{match:Rt,when:At,against:Bt,otherwise:Dt,anyOf:Ft}=l,{makeSettingGetter:kt,getConstruct:Mt}=me,{IdentifierIsAlreadyBigNumberMethod:Gt,withImportDeclaration:Ut,StringFromArguments:Pt}=_e,qt=kt("number",{parseFloat:["__CONSTRUCT__(${A})"],toExponential:"toExponential",toFixed:"decimalPlaces",toPrecision:"toPrecision",toString:"toString"});function Lt(e){const t=qt(e),r=Ft(Object.keys(t));return Bt(At({type:"CallExpression",callee:{type:"MemberExpression",property:{type:"Identifier",name:r}}})((function(r){const{property:n,object:a}=r.callee;if(Gt(e,n))return;const i=e.getSource(r);e.report({node:r,message:`is '${i}' a financial calculation?`,fix:i=>{const o=Mt(e),s=e.getSource(a),c=Pt(e)(r);return i.replaceText(r,Rt({node:r,method:t[n.name]})(At({node:{callee:{object:{name:"Number"}}},method:Array.isArray})((({method:e})=>e[0].replace("__CONSTRUCT__",o).replace("${O}",s).replace("${A}",c))),Dt((({method:e})=>`${o}(${s}).${e}(${c})`))))}})})))}var Jt={create:e=>({CallExpression:Ut(e,Lt(e))}),meta:{category:"Financial, Currency",description:"Replace JavaScript Number.prototype methods with BigNumber equivalents",fixable:"code"}};const{getConstruct:Wt}=me,{makeGlobalIdentifierFixer:Vt,withImportDeclaration:Ht}=_e,zt=Vt({parseFloat:e=>Wt(e)});var Kt={create:e=>({Identifier:Ht(e,zt(e))}),meta:{category:"Financial, Currency",description:"Replace parseFloat with BigNumber equivalent",fixable:"code"}};const{against:Qt,when:Xt,match:Yt,otherwise:Zt,anyOf:er}=l,{makeSettingGetter:tr,getConstruct:rr}=me,{withImportDeclaration:nr}=_e,ar={floor:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_FLOOR\n})",ceil:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_CEIL\n})",round:"BigNumber.set({\n  ROUNDING_MODE: BigNumber.ROUND_HALF_EVEN\n})"},ir=tr("supportsRound",!1),or=tr("rounding",ar);function sr(e){const t=er(Object.keys(ar)),r=or(e),n=ir(e);return Qt(Xt({type:"CallExpression",callee:{type:"MemberExpression",object:{name:"Math"},property:{name:t}}})((function(t){const a=e.getSource(t),i=t.callee.property.name;if(!n)return void e.report({node:t,message:`is '${a}' a financial calculation? If so, use the global constructor setting:\n\n${r[i]}\n`});e.report({node:t,message:`is '${a}' a financial calculation?`,fix:n=>{const a=rr(e),o=r[i],s=t.arguments.map((t=>e.getSource(t))).join(", ");return n.replaceText(t,Yt(o)(Xt({length:1})((e=>e[0].replace("__CONSTRUCT__",a).replace("${A}",s))),Xt({length:2})((e=>{const t=e[0],r=e.slice(1).map((e=>e.replace("${A}",s)));return`${a}.${t}(${r})`})),Zt((e=>`${a}.${e}(${s})`))))}})})))}function cr(e){const t=or(e),r=ir(e);return Qt(Xt({type:"UnaryExpression",operator:"~",argument:{operator:"~"}})((function(n){const a=e.getSource(n),i=t.floor;if(!r)return void e.report({node:n,message:`is '${a}' a financial calculation? If so, use the global constructor setting:\n\n${i}\n`});e.report({node:n,message:`is '${a}' a financial calculation?`,fix:t=>{const r=e.getSource(n?.argument?.argument),a=rr(e);return t.replaceText(n,Yt(i)(Xt({length:1})((e=>e[0].replace("__CONSTRUCT__",a).replace("${A}",r))),Xt({length:2})((e=>{const t=e[0],n=e.slice(1).map((e=>e.replace("${A}",r)));return`${a}.${t}(${n})`})),Zt((e=>`${a}.${e}(${r})`))))}})})))}var lr={rules:{arithmetic:Qe,assignment:mt,isNaN:$t,math:Tt,number:Jt,parseFloat:Kt,rounding:{create:e=>({CallExpression:nr(e,sr(e)),UnaryExpression:nr(e,cr(e))}),meta:{category:"Financial, Currency",description:"Warn against using JavaScript Math.round|ceil|floor methods, or offer replacements",fixable:"code"}}},configs:{recommended:{rules:{"big-number-rules/arithmetic":"warn","big-number-rules/assignment":"warn","big-number-rules/isNaN":"warn","big-number-rules/math":"warn","big-number-rules/number":"warn","big-number-rules/parseFloat":"warn","big-number-rules/rounding":"warn"}}}};module.exports=lr;
